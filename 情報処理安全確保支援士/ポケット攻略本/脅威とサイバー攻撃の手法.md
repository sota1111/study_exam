# 情報セキュリティとは

## 情報セキュリティの定義
経営資源を脅威から守り、安全に経営を行うための活動全般。

## CIA
利便性と安全性はトレードオフの関係。
セキュリティ対策の円滑な実施には、経営層の参加による強制力が必要。
- C：機密性
- I：完全性
- A：可用性

### 機密性(Confidentality)
ある情報を**許可された利用者**だけが**許可された範囲内**で利用できる状態を「**機密性がある**」という。

### 完全性(Integrity)
情報が**完全で正確**であることが保証された状態を「**完全性がある**」という。

### 可用性(Availability)
利用者がある**情報を使いたいと思った時**に、**いつでも使える状態**を「**可用性がある**」という。



# リスク

## リスクとは
リスクは**情報資産**と**脅威**と**脆弱性**が結びつくことにより顕在化して、現実のものになる。
<u>セキュリティ対策とは、リスクの３つの要素のうち、少なくとも１つを取り除くこと</u>

## 情報資産
情報資産は「大事なもの」。

## 脅威
**脅威は、情報資産を脅かすもの**
攻撃者の不正侵入、マルウェア、泥棒、自然災害など。

### 物理的脅威
- 火災、落雷などの自然災害
- 盗難・破壊
- 機器の故障

### 技術的脅威
- ソフトウェアのバグ
- マルウェア、不正アクセス、盗聴

### 人的脅威
- 操作ミスによるデータや機器の故障
- 内部犯による情報漏えいや内通
フールプルーフなどのミスを起こさせない設計をする

## 脆弱性
脆弱性は、脅威につけ込まれる隙は弱点。

### 物理的脆弱性
目に見える形で掲示される脆弱性
- 耐震・耐火構造の不備
- 機器故障対策の不備
- 紛失対策の不備

### 技術的脆弱性
**セキュリティホール**の存在や、アクセスコントロールの不備など、**目に見えない**のが特徴。
- アクセスコントロールの不備
- マルウェア対策の不備
- セキュリティホール
ペネとレーションテスト：攻撃者が行うような攻撃を、実際に行い、脆弱性を検証する手法

### 人的脆弱性

#### 組織管理の不備
その業務に必要最小限の権限を付与する、業務プロセスを透明化や相互監視体制を構築して対応→最小権限の原則

#### 過失
人が業務を行う以上、不可避の脅威→フールプルーフのような仕組みで対応

リスクを発見、認識及び記述するプロセス



# 攻撃者

## 攻撃者の目的
- 金銭：最も多い動機。ランサムウェアなどは典型的な例で、他人のコンピュータをロックして身代金を要求する。
- 社会運動：ハクティビズムと呼ばれ、行う者をハクティビストと呼ぶ。何らかの政治目的を達成するために情報の漏えい・暴露を行ったり、ある企業に社会的制裁を加えるためにフェイクニュースを流通させるなど行う。
- 自己顕示欲：ハッキングによって自分の高度な技術アピールするもの。
- 諜報：国家を背景とした諜報機関などが行う攻撃。潤沢な資金を投じた高度で組織的な攻撃が特徴。

## 攻撃者の種類

### ホワイトハッカー
ハッキング能力を行政や企業のセキュリティ確保に使おうとする者

### ブラックハッカー
高度な情報スキルを悪用して金銭的利益などを得る職業的な攻撃者

### スクリプトキディ
情報技術には疎いものの、高度なスキルを持つハッカーが開発・配布した攻撃ツールなどを使い情報システムを攻撃する者

### 内部犯
企業や組織の内部犯がその組織を攻撃する者。
ゼロトラストなどは内部犯を視野に入れたセキュリティ対策手法。

### 不正のトライアングル
不正が生じる３つの原因。機会と動機と正当化が揃った時に不正が行われるリスクが顕在化する。



# リスクマネジメント

## リスクマネジメント
- リスクアセスメント
  - リスク分析
  - リスク評価
- リスク対応
  - リスク回避
  - リスク最適化
  - リスク移転
  - リスク保有
- リスク受容
- リスクコミュニケーション

## リスクアセスメント
自社のリスクを分析し、そのリスクを評価する。

### ベースラインアプローチ
標準化されたツールやガイドラインを自社に適用して、リスクを洗い出す。
低コスト、低難易度が特徴だが、自社特有のリスクを見逃す可能性がある。

### 詳細リスク分析
情報資産の洗い出しから、脅威の把握、脆弱性の検証までを丹念に積み重ねる。リスクの正確な把握に特徴があるが、手間がかかり、評価者にも高いスキルが求められる。

### 複合アプローチ
一般的な業務にはベースラインアプローチ、重要業務には詳細リスク分析といった具合にメリハリをつけることで、コストと効果のバランスを目指す方法。

## リスク対応

### リスク回避
リスクがある資産そのものを無くしてしまう方法。

### リスク低減
セキュリティソフトを入れるなど、リスクは存在しつつも、その発生頻度や被害額を小さくしようとするもの。

### リスク移転
保険を掛けたり、アウトソースするなど、リスクを別の人に引き受けて貰おうとする対応方法。

### リスク保有
リスクを持ち続けること。予想被害額より対策費の方が大きいので敢えて何もしない。

## ポイント
- 優先度を付ける
- リスクの受容水準を決める



# 情報収集と共有

## 脆弱性情報を公開する
脆弱性情報データベースを「公開した方が良い」という思想で作られている。

### JVN
日本で最もお馴染みの脆弱性情報データベース。
IPCERT/CCとIPAが管理・運用している。
日本語情報の質・量は最大

### CVE（共通脆弱性識別子）
アメリカの非営利団体であるMITREが管理している脆弱性情報。
世界有数のデータベースであること、ベンダに依存しない情報を提供することが大きな特徴。
CVEは脆弱性に一意な番号（CVE-ID）をつけ、脆弱性の網羅と重複防止に貢献

### CVSS(Common Vulnerability Scoring System)
CVSS（共通脆弱性評価システム）とは、情報システムの脆弱性情報を包括的に収集し、一貫性のある評価基準で示す仕組み。
FIRST(Forum of Incident and Security Teams)が管理・運営を行う。
脆弱性の評価に以下の３つの基準を使う。

#### 基本評価基準
脆弱性の特性を表す。この脆弱性が機密性、完全性、可用性にどう影響するかを評価し、**CVSS基本値**（固定値）として算出する。その脆弱性の基本的な深刻度が分かる。

#### 現状評価基準
脆弱性の現在の深刻度を表す。同じ脆弱性でも、エクスプロイトや修正バッチの有無などでリスクの大きさが異なるため、これらを加味して**CVSS現状値**（可変値）として算出する。

#### 環境評価基準
最終的な脆弱性の深刻度を表す。同じ脆弱性でも利用者の環境によってはリスクの大きさが異なるため、これらを加味して**CVSS環境値**（可変値）として算出する。

### CWE(Coommon Weakness Enumeration)
CWE（共通脆弱性タイプ一覧）とは、ソフトウェアが持ちうる脆弱性の種類を体系化・標準化したもの
脆弱性のタイプを大きく４つに分類し、その中でさらに細分化する。

#### ビュー
ある観点（例えば開発者視点、研究者視点など）から脆弱性を集めたもの。C言語が原因となるもの、Javaが原因となるものなど、プログラミング言語に着目したビューもある。

#### カテゴリー
特性によって脆弱性をグループ化したもの。暗号に関する脆弱性、ユーザインタフェースに関する脆弱性などと分類されている。

#### 脆弱性
個々の脆弱性を表すもの。最も抽象的なクラス（例：リソースの競合）、特定の技術に依存しないベース（例：共有データへの非同期アクセス）、個々の技術に結びついたバリアント（例：セッションを適切に識別できない）に分けられている。

#### 複合要因
複数の要因による脆弱性を表す。複数の脆弱性が結びついたものをコンポジット、あるトラブルが別のトラブルを引き起こして脆弱性を発生させるものをチェインと呼ぶ。

### PCI DSS(Payment Card Industry Data Security Standard)
PCI DSSはクレジットカード業界のセキュリティ標準。
情報システムそのものの技術的なセキュリティ対策を目指している。
主な内容は以下。
- 安全なネットワークの構築と維持
- カード会員データの保護
- 脆弱性管理プログラムの維持
- 強力なアクセス制御手法の導入
- ネットワークの定期的な監視及びテスト
- 情報セキュリティポリシーの維持

### J-CSIP
サイバー情報共有イニシアティブのことで、IPAが管理・運用する。
サイバー攻撃などに対する攻撃をシェアすることで、重要インフラなどを担う企業が情報を提供しやすくしている。



# ポートスキャン

## 不正アクセス
通常のアクセスと不正アクセスを隔てる境界は不正アクセス禁止法によって定義される。
- 正規の利用権限を持ってない、あるいは権限以上の行為をネットワークを介して行うこと。
- 保護対象はアクセスコントロールされているシステム。
- セキュリティホールを突いた攻撃も不正アクセスとなる。

### ネットワークスキャン
ICMPのツールであるpingを使って手当たり次第に疎通確認を行い、実在するPCを調べるネットワークスキャンはその一つ。

#### 対策
pingはネットワーク管理に便利だが、応答しないように設定するとセキュリティは向上する。
NATを使うと、外部からネットワーク構成を把握しにくくなる。

### ポートスキャン
ネットワークスキャンなどで実在するPCのIPアドレスが判明すると、今度はそのPCの開いている（接続できる）ポートが探られる。

#### ポートが開いているか調べる方法
接続可能なポートからSYN、ACKが返信があることで確認される。

#### 対策
不必要なポートを閉じる。
IDSの導入



# バッファオーバーフロー
メモリ上に用意された領域を超えてデータ格納しようとすると、他のデータ用に確保された領域を侵し、データ破壊や誤作動を引き起こさせること。

## バッファオーバーフローの仕組み
攻撃者の攻撃が高度である場合は、単に誤作動を起こすだけでなく、リターンアドレスの部分に正確に別のアドレスを上書きされ、そこに格納されたプログラムを実行することさえ可能。

### ヒープ攻撃
プログラムから動的に確保・解放できるメモリ領域。

#### バッファオーバーフローへの対策
- バッファに書き込まれるデータのサイズは必ず確認する。
- サイズオーバーの場合、実行を止めるか、バッファを拡大する。

## C言語でのバッファオーバーフロー対策

### 危険な関数と置き換え
バッファの上限を指定できたり、サイズオーバー時に自動的にバッファを拡張する関数が整備されている。

### 終端文字
C言語では、文字列の最後を表すのに終端文字(null, %00)を使う。
そのため、利用者からの文字入力を受け付けるフォームで終端文字を入力されると、思わぬ誤作動を引き起こすことがある。
上記を利用して、利用者が勝手に拡張子を付けることなどができる。

#### 対策
- 利用者が入力したデータは絶対に信用せず、チェックする。
- 不正な文字を見つけた時は、エスケープ処理などで無害化する。
- 終端文字も１文字分のデータ。サイズ計算では注意する。







