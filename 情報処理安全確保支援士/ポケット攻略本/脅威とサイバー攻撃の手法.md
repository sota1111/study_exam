# 情報セキュリティとは

## 情報セキュリティの定義
経営資源を脅威から守り、安全に経営を行うための活動全般。

## CIA
利便性と安全性はトレードオフの関係。
セキュリティ対策の円滑な実施には、経営層の参加による強制力が必要。
- C：機密性
- I：完全性
- A：可用性

### 機密性(Confidentality)
ある情報を**許可された利用者**だけが**許可された範囲内**で利用できる状態を「**機密性がある**」という。

### 完全性(Integrity)
情報が**完全で正確**であることが保証された状態を「**完全性がある**」という。

### 可用性(Availability)
利用者がある**情報を使いたいと思った時**に、**いつでも使える状態**を「**可用性がある**」という。



# リスク

## リスクとは
リスクは**情報資産**と**脅威**と**脆弱性**が結びつくことにより顕在化して、現実のものになる。
<u>セキュリティ対策とは、リスクの３つの要素のうち、少なくとも１つを取り除くこと</u>

## 情報資産
情報資産は「大事なもの」。

## 脅威
**脅威は、情報資産を脅かすもの**
攻撃者の不正侵入、マルウェア、泥棒、自然災害など。

### 物理的脅威
- 火災、落雷などの自然災害
- 盗難・破壊
- 機器の故障

### 技術的脅威
- ソフトウェアのバグ
- マルウェア、不正アクセス、盗聴

### 人的脅威
- 操作ミスによるデータや機器の故障
- 内部犯による情報漏えいや内通
フールプルーフなどのミスを起こさせない設計をする

## 脆弱性
脆弱性は、脅威につけ込まれる隙は弱点。

### 物理的脆弱性
目に見える形で掲示される脆弱性
- 耐震・耐火構造の不備
- 機器故障対策の不備
- 紛失対策の不備

### 技術的脆弱性
**セキュリティホール**の存在や、アクセスコントロールの不備など、**目に見えない**のが特徴。
- アクセスコントロールの不備
- マルウェア対策の不備
- セキュリティホール
ペネとレーションテスト：攻撃者が行うような攻撃を、実際に行い、脆弱性を検証する手法

### 人的脆弱性

#### 組織管理の不備
その業務に必要最小限の権限を付与する、業務プロセスを透明化や相互監視体制を構築して対応→最小権限の原則

#### 過失
人が業務を行う以上、不可避の脅威→フールプルーフのような仕組みで対応

リスクを発見、認識及び記述するプロセス



# 攻撃者

## 攻撃者の目的
- 金銭：最も多い動機。ランサムウェアなどは典型的な例で、他人のコンピュータをロックして身代金を要求する。
- 社会運動：ハクティビズムと呼ばれ、行う者をハクティビストと呼ぶ。何らかの政治目的を達成するために情報の漏えい・暴露を行ったり、ある企業に社会的制裁を加えるためにフェイクニュースを流通させるなど行う。
- 自己顕示欲：ハッキングによって自分の高度な技術アピールするもの。
- 諜報：国家を背景とした諜報機関などが行う攻撃。潤沢な資金を投じた高度で組織的な攻撃が特徴。

## 攻撃者の種類

### ホワイトハッカー
ハッキング能力を行政や企業のセキュリティ確保に使おうとする者

### ブラックハッカー
高度な情報スキルを悪用して金銭的利益などを得る職業的な攻撃者

### スクリプトキディ
情報技術には疎いものの、高度なスキルを持つハッカーが開発・配布した攻撃ツールなどを使い情報システムを攻撃する者

### 内部犯
企業や組織の内部犯がその組織を攻撃する者。
ゼロトラストなどは内部犯を視野に入れたセキュリティ対策手法。

### 不正のトライアングル
不正が生じる３つの原因。機会と動機と正当化が揃った時に不正が行われるリスクが顕在化する。



# リスクマネジメント

## リスクマネジメント
- リスクアセスメント
  - リスク分析
  - リスク評価
- リスク対応
  - リスク回避
  - リスク最適化
  - リスク移転
  - リスク保有
- リスク受容
- リスクコミュニケーション

## リスクアセスメント
自社のリスクを分析し、そのリスクを評価する。

### ベースラインアプローチ
標準化されたツールやガイドラインを自社に適用して、リスクを洗い出す。
低コスト、低難易度が特徴だが、自社特有のリスクを見逃す可能性がある。

### 詳細リスク分析
情報資産の洗い出しから、脅威の把握、脆弱性の検証までを丹念に積み重ねる。リスクの正確な把握に特徴があるが、手間がかかり、評価者にも高いスキルが求められる。

### 複合アプローチ
一般的な業務にはベースラインアプローチ、重要業務には詳細リスク分析といった具合にメリハリをつけることで、コストと効果のバランスを目指す方法。

## リスク対応

### リスク回避
リスクがある資産そのものを無くしてしまう方法。

### リスク低減
セキュリティソフトを入れるなど、リスクは存在しつつも、その発生頻度や被害額を小さくしようとするもの。

### リスク移転
保険を掛けたり、アウトソースするなど、リスクを別の人に引き受けて貰おうとする対応方法。

### リスク保有
リスクを持ち続けること。予想被害額より対策費の方が大きいので敢えて何もしない。

## ポイント
- 優先度を付ける
- リスクの受容水準を決める



# 情報収集と共有

## 脆弱性情報を公開する
脆弱性情報データベースを「公開した方が良い」という思想で作られている。

### JVN
日本で最もお馴染みの脆弱性情報データベース。
IPCERT/CCとIPAが管理・運用している。
日本語情報の質・量は最大

### CVE（共通脆弱性識別子）
アメリカの非営利団体であるMITREが管理している脆弱性情報。
世界有数のデータベースであること、ベンダに依存しない情報を提供することが大きな特徴。
CVEは脆弱性に一意な番号（CVE-ID）をつけ、脆弱性の網羅と重複防止に貢献

### CVSS(Common Vulnerability Scoring System)
CVSS（共通脆弱性評価システム）とは、情報システムの脆弱性情報を包括的に収集し、一貫性のある評価基準で示す仕組み。
FIRST(Forum of Incident and Security Teams)が管理・運営を行う。
脆弱性の評価に以下の３つの基準を使う。

#### 基本評価基準
脆弱性の特性を表す。この脆弱性が機密性、完全性、可用性にどう影響するかを評価し、**CVSS基本値**（固定値）として算出する。その脆弱性の基本的な深刻度が分かる。

#### 現状評価基準
脆弱性の現在の深刻度を表す。同じ脆弱性でも、エクスプロイトや修正バッチの有無などでリスクの大きさが異なるため、これらを加味して**CVSS現状値**（可変値）として算出する。

#### 環境評価基準
最終的な脆弱性の深刻度を表す。同じ脆弱性でも利用者の環境によってはリスクの大きさが異なるため、これらを加味して**CVSS環境値**（可変値）として算出する。

### CWE(Coommon Weakness Enumeration)
CWE（共通脆弱性タイプ一覧）とは、ソフトウェアが持ちうる脆弱性の種類を体系化・標準化したもの
脆弱性のタイプを大きく４つに分類し、その中でさらに細分化する。

#### ビュー
ある観点（例えば開発者視点、研究者視点など）から脆弱性を集めたもの。C言語が原因となるもの、Javaが原因となるものなど、プログラミング言語に着目したビューもある。

#### カテゴリー
特性によって脆弱性をグループ化したもの。暗号に関する脆弱性、ユーザインタフェースに関する脆弱性などと分類されている。

#### 脆弱性
個々の脆弱性を表すもの。最も抽象的なクラス（例：リソースの競合）、特定の技術に依存しないベース（例：共有データへの非同期アクセス）、個々の技術に結びついたバリアント（例：セッションを適切に識別できない）に分けられている。

#### 複合要因
複数の要因による脆弱性を表す。複数の脆弱性が結びついたものをコンポジット、あるトラブルが別のトラブルを引き起こして脆弱性を発生させるものをチェインと呼ぶ。

### PCI DSS(Payment Card Industry Data Security Standard)
PCI DSSはクレジットカード業界のセキュリティ標準。
情報システムそのものの技術的なセキュリティ対策を目指している。
主な内容は以下。
- 安全なネットワークの構築と維持
- カード会員データの保護
- 脆弱性管理プログラムの維持
- 強力なアクセス制御手法の導入
- ネットワークの定期的な監視及びテスト
- 情報セキュリティポリシーの維持

### J-CSIP
サイバー情報共有イニシアティブのことで、IPAが管理・運用する。
サイバー攻撃などに対する攻撃をシェアすることで、重要インフラなどを担う企業が情報を提供しやすくしている。



# ポートスキャン

## 不正アクセス
通常のアクセスと不正アクセスを隔てる境界は不正アクセス禁止法によって定義される。
- 正規の利用権限を持ってない、あるいは権限以上の行為をネットワークを介して行うこと。
- 保護対象はアクセスコントロールされているシステム。
- セキュリティホールを突いた攻撃も不正アクセスとなる。

### ネットワークスキャン
ICMPのツールであるpingを使って手当たり次第に疎通確認を行い、実在するPCを調べるネットワークスキャンはその一つ。

#### 対策
pingはネットワーク管理に便利だが、応答しないように設定するとセキュリティは向上する。
NATを使うと、外部からネットワーク構成を把握しにくくなる。

### ポートスキャン
ネットワークスキャンなどで実在するPCのIPアドレスが判明すると、今度はそのPCの開いている（接続できる）ポートが探られる。

#### ポートが開いているか調べる方法
接続可能なポートからSYN、ACKが返信があることで確認される。

#### 対策
- 不必要なポートを閉じる。
- IDSの導入。



# バッファオーバーフロー
メモリ上に用意された領域を超えてデータ格納しようとすると、他のデータ用に確保された領域を侵し、データ破壊や誤作動を引き起こさせること。

## バッファオーバーフローの仕組み
攻撃者の攻撃が高度である場合は、単に誤作動を起こすだけでなく、リターンアドレスの部分に正確に別のアドレスを上書きされ、そこに格納されたプログラムを実行することさえ可能。

### ヒープ攻撃
プログラムから動的に確保・解放できるメモリ領域。

#### バッファオーバーフローへの対策
- バッファに書き込まれるデータのサイズは必ず確認する。
- サイズオーバーの場合、実行を止めるか、バッファを拡大する。

## C言語でのバッファオーバーフロー対策

### 危険な関数と置き換え
バッファの上限を指定できたり、サイズオーバー時に自動的にバッファを拡張する関数が整備されている。

### 終端文字
C言語では、文字列の最後を表すのに終端文字(null, %00)を使う。
そのため、利用者からの文字入力を受け付けるフォームで終端文字を入力されると、思わぬ誤作動を引き起こすことがある。
上記を利用して、利用者が勝手に拡張子を付けることなどができる。

#### 対策
- 利用者が入力したデータは絶対に信用せず、チェックする。
- 不正な文字を見つけた時は、エスケープ処理などで無害化する。
- 終端文字も１文字分のデータ。サイズ計算では注意する。



# パスワードの不正入手

## パスワード奪取方法

### ブルートフォースアタック
- 方法：考えられる全てのパスワードの組み合わせを試す。
- 対策：文字数や文字種を増やし、組み合わせを多くする。

### 辞書攻撃
- 方法：ありがちなパスワードを試す。
- 対策：推測できないパスワードにする。

### ソーシャルエンジニアリング
同僚を装ってパスワードを電話で聞き出す等の技術以外の方法。

## 不正侵入成立後の攻撃者の行動

### ログの消去
攻撃者はログを消して、自らの行動を隠蔽しようとする。

### バックドアの作成
正規の手順によらないシステムへのアクセス経路。

### 不正侵入の対策
- ログファイルを別マシンなど推測しにくい場所に置く。
- 暗号化やデジタル署名などで、改ざんしにくくする。
- 上書き不能なメディアに保存する。
- セキュリティパッチの適用
- IDSなどによるPCから送信されるデータのチェック



# セッションハイジャック
現在行われている通信に割り込んで、通信を乗っ取る攻撃方法の総称。

## セッションハイジャック
現在行われている通信を乗っ取ることで、攻撃者が正規の利用者のように相手と通信してしまうこと。

### 中間者攻撃
通信間に入り、通信相手と誤認させること。

### TCPにおけるセッションハイジャック
現パケットのセッション番号を入手し、次に送られるであろうセッション番号を付与したパケットを偽装する。

### HTTPにおけるセッションハイジャック
セッション番号をURLに埋め込む方法や、hiddenフィールド、Cookieを使う方法がある。
これらの情報がクリアテキストで送信されていないか、第三者に転送されてしまう設定になっていないことが重要。

### UDP
セッションの概念がないため、攻撃者にとって乗っ取りの低いプロトコル。

### 対策
- セッション番号の割り当てに乱数を使う。
- 暗号化と認証を行う。
- ポート番号をランダムに選択する。

## セッションフィクセーション
セッション番号をフィックスすることで、なりすましを行う方法。

### 攻撃ステップ
- 攻撃者は自分でwebサーバにアクセスしたり、ログインしたりする。
- そこで得たセッション番号を、利用者に強制的に使われる。
- セッションの有効期限内に同一セッション番号でアクセスすれば、正規利用者と同じ権限でサーバが使える。

#### 対策
セッション番号の有効期限を短くしたり、ログインごとに変更するなどして対策する。



# 盗聴
- ネットワーク上を流れるデータを不正に傍受する。
- キーボードロギングのようなローカルな情報窃取も盗聴と呼ばれる。

## スニファ
ネットワーク上を流れるデータを取得して、内容を解析する。

### プロトコルアナライザ
パケットの取得と解析を行う。キャプチャソフトでも同様の作業が行える。

#### 設置場所
- キャプチャしたいパケットが流れるセグメント内
- スイッチングハブ等でセグメントが細分化されている場合、ミラーリングポート

### プロミスキャスモード
NICのモードのひとつである全てのパケットを取得できるモード。

## 電波傍受

### テンペスト
- 内容：ケーブルから漏れる微細電磁波を読み取ったり、ディスプレイが発する電磁波から何が映っているかを再現したりする技術
- 対策：電磁波シールドのあるケーブルを使う。部屋全体を電磁波遮断材で作る。

### 無線LAN
- 内容：無線LANの傍受。電波の届く範囲にアンテナを立てる。
- 対策：基本的に防げない。

#### 無線LANの暗号化

##### WEP
過去の企画、弱い、破り方が知られている、ダメ

##### WPA
WEPから移行しやすいように工夫された。TKIP、RC4

##### WPA2
- CCMP
- AES暗号

##### WPA3
- SAE（事前共有鍵PSKより安全な仕組み）
- CNSA（暗号スイート）
- Easy Connect（IoT機器などを簡単に接続できる）
- Enhanced Open（公衆LANを安全にする）

## サイドチャネル攻撃
消費電力、処理時間、発熱、エラーメッセージなどからデータを読み取る手法。

## キーボードロギング
キーボード操作の記録を残すこと。

### 対策
- 一般的なセキュリティ対策が有効。
- 出所不明のファイルは開かない。
- ファイアウォールやIDSの設置も効果あり

IDS（Intrusion Detection System）は、企業や組織のネットワークを監視し、不正アクセスや疑わしい通信を検知するセキュリティサービス。

IPS（Intrusion Prevention System）は、侵入防御システムと呼ばれ、企業や組織のネットワークを監視し、不正アクセスやサイバー攻撃に使われる通信を検知し遮断するセキュリティサービス。

# なりすまし
他の誰かの誰かのフリをすること。

## ユーザID、パスワードの不正入手

## IPスプーフィング
IPアドレスと詐称して、実際に使っているマシンとは異なるIPアドレスが送信元であるように錯覚させる方法。

IPヘッダに含まれている送信元アドレスフィールドを書き換えることで可能。

### 対策
- 他の階層（トランスポート層やアプリケーション層）の情報を併用して通信を検査する。
- 前後のパケットとの関係を調べるステートフルインスペクションを行う。

## 踏み台攻撃
攻撃者が会社や省庁を攻撃するとき、他の人のコンピュータを経由して不正行為を行うこと。

### 対策
- 公開サーバのDMZ化
- パッチの適用

### 多段プロキシ
プロキシサーバを何台も経由する踏み台攻撃



# DoS攻撃
通常の範囲の通信を過剰に集中して、サービスの不全を引き起こす攻撃方法。


## DoS攻撃

### 具体的な攻撃の手段
- TCP SYN Flood：３ウェイハンドシェイク(SYN)を大量に送りつける。
- Connect Flood：大量のコネクションを確立させる。
- UDP Flood：UDPポートに大量のデータを送りつける。
- Ping Flood(ICMP Flood)：Pingを大量に送りつける。

- DDoS攻撃：DoS攻撃を大量のマシンから行う。
- DRDoS攻撃：踏み台サーバに、標的コンピュータに偽装したSYNパケットを投げる。

### 〜Floodという攻撃
「あふれさせる」の意味で〜Flood攻撃と名付けられている。

### TCP SYN Flood
TCPの3ウェイハンドシェイクを悪用した攻撃。

#### 対策
- CPUやメモリなどの資源は一定時間経過したら解放する
- IDSやIPSを導入する。
- 不要なポートを閉じる。
- IPアドレスの特定が可能な場合は、通信を遮断する。

### Connection Flood
TCP SYN Floodとよく似ているが、実際にコネクションを確立させる。
確立した方が資源の食い潰し度合いが大きいこと、コネクション制限数いっぱいまで確立すると他の利用者が通信できなくなることに特徴がある。

TCP SYN Floodの場合は確立要求だけなので架空のIPアドレスで攻撃できるが、Connection Floodでは攻撃側マシンのIPアドレスは、有効で実際に通信できるアドレスが必要となる。

### UDP Flood
TCP SYN FloodをUDPで行おうというもの。UDPポートに対してデータを送り続けることで攻撃を行う。シンプルな通信でヘッダ情報も少ないことから、攻撃時にも考慮する事項が少なく、比較的容易に実行できる。

### Ping Flood(ICMP Flood)
ping（ICMPエコー要求）を大量に送りつけることで、標的になったサーバのリソースを消費させ、サービスの遅滞や停止を試みる攻撃方法。
pingはノードの実在を確認でき、攻撃者に情報を提供してしまう側面もあるため、**pingに応答しない設定**（少なくともWAN側からのpingには応答しない）が一般的。

## DDoS攻撃
最初のDは分散の意味で、分散DoS攻撃と訳す。
やることはDoS攻撃と一緒だが、大量のマシンから行うことでより大規模に、より攻撃マシンを特定しにくい状態にすることができる。

攻撃にはボットネットが使われる。攻撃者が自前で準備するわけではなく、マルウェアに感染した大量のソンビPCが、攻撃者の指示で一斉に攻撃を行う。

## 分散反射型DoS攻撃(DRDoS)
DDoS攻撃の発展型。
攻撃者は攻撃の標的とするコンピュータのアドレスを送信元と偽装して、踏み台サーバにSYNパケットを送信する。

### DNSリフレクション攻撃
自分の管理下にあるDNSサーバ(A)に大きな情報を登録、再帰問い合わせをしているDNSサーバ(B)に、Aに問い合わせが行われるような名前解決を要求する。

たくさんのBに名前解決要求を送れば、標的の元には、大きなパケットが様々なアドレスから大量に届くことになる。攻撃の過程でパケットサイズが大きくなるため、**DNS増幅攻撃（DNS amp攻撃）**とも呼ばれる。

### DNS水攻め攻撃
DNSサーバに対して、ランダムなサブドメインを問い合わせる攻撃方法。
**ランダムサブドメイン攻撃**とも言う。

## その他のDoS攻撃

### EDoS攻撃(Economic Denial of Service attack)
経済的な負担を強いるタイプのDoS攻撃。

### マルチベクトル型DDoS攻撃
複数のDDoS攻撃手法を組み合わせて、よりダメージを大きく、対策しにくくするやり方。

### NTPリフレクション攻撃（NTP増幅型DDoS攻撃）
増幅型攻撃は効率の良いDoS攻撃手法で、送信データよりも返信データの方が大きくなるサービスを行なっているサーバは、常に増幅型攻撃の対象になり得る。

### 反射攻撃に利用されやすいプロトコル
- 特に認証等なしに応答するプロセスがあること
- リクエストに比べて、応答部分が大きいこと

### SMURF攻撃
攻撃者がインターネット制御メッセージプロトコル（ICMP）パケットを大量に送って標的サーバーを圧倒しようとするDDoS攻撃



# Webシステムへの攻撃

## Webビーコン
HTMLメールにimgタグで画像を埋め込み、標的に送信。標的がメールを開くと、imgタグで指定された画像を攻撃者のサーバへ読み込みに行き、標的が実在するか、どのような話題に興味があるか調べられる。

### 目的
- 標的に行動監視。
- マーケティングや詐欺などの準備行動。

### 対処
- メールをテキストとして読み込む。
- 画像の読み込みをブロックする。

## フィッシング
有名なサイト、標的が信頼しているサイトになりすまして、重要情報を窃取する攻撃方法。

### 誘導方法
- 似たようなアドレスを用意。
- なりすましサイトへのリンク込みメールが来る。

#### 対策
- URLの打ち間違いに注意する。
- 信頼できる検索エンジンから検索する。
- メールソフト、セキュリティ対策ソフトのフィッシング対策機能を使う。
- メールのリンクを踏まない。

## ファーミング
フィッシングを発展させた攻撃手法。DNSキャッシュポイズニングが使われる。

### DNSキャッシュポイズニング
偽のDNS応答をキャッシュDNSサーバーにキャッシュさせることで偽のサイトに誘導し、ドメインの乗っ取りやフィッシングなどを図る攻撃手法。



# スクリプト攻撃

## クロスサイトスクリプティング(XSS)
不正スクリプトを信頼されているサーバに埋め込み、利用者に送られ、実行される。

### Reflected XSS
利用者に悪意のあるスクリプトが含まれたURLを踏ませるなどして不正なリクエストをさせ、それがサーバ側で処理され不正ページとして生成され利用者に返ってくるタイプのXSS。

### Stored XSS
攻撃者が悪意のあるスクリプトをWebサーバに混入させ、利用者がアクセスするたびにサーバがスクリプト入りの不正ページを生成、利用者に表示してしまうタイプのXSS。

### DOM based XSS
DOMはHTMLを操作するAPIのこと。攻撃者がこれを悪用し、Webサーバに悪意のあるスクリプトを含んだ不正ページを動的に生成、利用者に送信・表示してしまうタイプのXSS。

## クロスサイトリクエストフォージュリ(CSRF)
ログイン状態を乗っ取る攻撃手段。

### 攻撃手順
- 利用者のマシンが掲示板へのログイン状態にある。
- 攻撃者の不正スクリプト込みWebページを利用者が見る。
- 不正スクリプトが利用者のログイン権限で掲示板に書き込まれる。

### 対策
- ログインのしっぱなしは避ける
- WAFの導入
- スクリプトを無効にする（副作用に注意）

## HTTPヘッダインジェクション
HTTPヘッダに不正な文字列を挿入する攻撃手法。



# SQLインジェクション
データベース操作言語であるSQLを不正注入することで、思いのままにデータを操る攻撃手法。

## SQLインジェクション

### 対策
- データベースのバインド機構を使う。
- エスケープ処理を行う。
- データベースにアクセスするサーバに過剰な権限を持たせない。
- 公開サーバは詳細なエラーメッセージを表示しない。

## OSコマンドインジェクション
OSのコマンドを注入する攻撃手法。
OSコマンドの呼び出し情報に不正な値を混入することで、好きなコマンドを実行する。

### 対策
- OSコマンドを直接呼び出す関数は使わない。
- 使わざるを得ない場合は、エスケープ処理を行う。



# DNSキャッシュポイズニング
DNSに偽の情報を書き込むことでインターネット上の通信の流れを操ることができる。

## DNSサーバの２つの種類

### キャッシュサーバ
- リゾルバに応えるのが仕事。
- コンテンツサーバに再帰問い合わせをする。
- 問い合わせ結果はキャッシュして、次回以降の応答を迅速化する。

### コンテンツサーバ
- 名前解決情報のオリジナルを保管するのが仕事。
- キャッシュサーバに応える。
- 権威サーバとも呼ばれる。

#### DNSの名前解決
- リゾルバがキャッシュサーバに問い合わせ。
- キャッシュに情報があれば応答、なければコンテンツサーバに転送。
- コンテンツサーバから教えてもらった情報は、しばらくキャッシュされる。

## DNSキャッシュポイズニングの手順
キャッシュサーバに偽の名前解決情報を登録させることで、そこに問い合わせを行ったリゾルバに任意のIPアドレスを教え、通信を誘導する攻撃手法。

### 完成の手順
- 攻撃者がキャッシュサーバに問い合わせる。
- キャッシュサーバはコンテンツサーバに再帰問い合わせを行う。
- コンテンツサーバの応答より早く、攻撃者が偽の応答を行う。
- 偽の名前解決情報がキャッシュサーバに登録される。

※ DNSは応答の真正性をトランザクションIDとポート番号で確認する。
トランザクションIDの推測は、管理者が安易な設定を用いていると容易。

### 対策
- トランザクションIDをランダムに割り振る
- 再帰問い合わせ時の送信元ポート番号をランダムにする

## DNSSEC
DNSを拡張したプロトコルで、DNSの名前解決情報をデジタル署名で認証する。攻撃者が偽造した名前解決情報は認証されず、キャッシュサーバの汚染が起こらない。

### 手順
- DNSの名前解決情報のハッシュ値からデジタル署名を作る。
- デジタル署名をRRSIGレコードとして登録する。
- 名前解決情報を受け取った側は、RRSIGレコードを公開鍵で検証する。

## DNS Changer
攻撃者が使うマルウェアの一種で、目的はDNSキャッシュポイズニングと同じ。悪意のあるサイトへブラウザを導こうとする。
相違点は、DNSキャッシュポイズニングがDNSサーバのリソースレコードを不正に書き換えるのに対し、DNS Changerは攻撃者が用意した不正なDNSサーバに問い合わせを行う。



# その他の攻撃手段

## 標的型攻撃
特定の人や組織に対象を絞り込んで、その対象に特化した知識や攻撃手法を用いて行われる攻撃の総称。

### サイバーキルチェーン
サイバー空間における攻撃者の行動を７つのパターンに分解・可視化したもの。

偵察、武器化、配達、攻撃、インストール、命令と制御、目的の達成

#### 特徴
- 手間がかかっている
- 対策が難しい

#### 対策
- 利用者の情報リテラシをあげる
- 出口対策、アウトバウンドトラフィックの監視が効果的

### ルートキット
攻撃者が使う攻撃用ツールがパッケージ化されたもの。

### ランサムウェア
マルウェアの一種。ランサムとは**身代金**のこと。

#### 対策
出所が不明なファイルは開かない、セキュリティ対策ソフトを使う、バックアップを取得しておく、最小権限の原則を守る。

## ファイル名の偽装

### 二重拡張子
拡張子を偽装する方法の一つ。

### RLO
文字列の表示を右から左へ行うように変更できる制御文字。



# ソーシャルエンジニアリング

## よく使われ、効果的なソーシャルエンジニアリング
IT技術によらず機密情報や管理者権限を入手したり、標的を思い通りに動かしたりする方法の総称。

### ショルダーハッキング
利用者が暗証番号などを入力している様子を肩口から覗き込んで、情報を窃取する方法。

#### 対策
- ATMバックミラー
- ディスプレイにのぞき見防止フィルタ

### スキャベンジング
ゴミ箱をあさること。

#### 対策
- 物理的に破壊する。
- 論理的に破壊する。
- 廃棄業者を利用する場合は、守秘義務契約を結ぶ。

### 会話
業務担当者同士の会話。

#### 対策
- 公共の会話で、業務の話題を出さない。
- 相手が上司でも、手順外の情報提供などはしない。



# マルウェア

## コンピュータウイルスの定義

### ウイルスの３機能
以下の一つでも該当すること。
- 自己伝染機能：自分自身のコピーを作って、感染を広げていく機能
- 潜伏機能：感染しても、しばらく大人しくしている機能
- 発病機能：実際に悪意のある行動を行う機能

## ウイルス（マルウェア）の分類
現状では、悪意のあるソフトウェア全般をマルウェアと呼ぶ。
- ウイルス（狭義）：他のプログラムに寄生する
- ワーム：単独での伝染、発病が可能
- トロイの木馬：有用な機能も持つが、背後で発病する

## マルウェアの感染経路

### 媒体感染
SDカードやUSBメモリなど記憶媒体を介して感染する経路。こうした補助記録装置には自動再生機能がついているものもあり、PCに挿しただけで感染させることも可能。

### ネットワーク感染
ネットワークを介して感染する経路。伝搬速度が速いのが特徴。

## マクロウイルス
ワープロソフトや表計算ソフトのマクロ機能を利用したウイルス。

## ボットネット
攻撃者の思い通りに動くPC（ソンビPC)で作られたネットワーク。
ボット（ボットネット構築用マルウェア）に感染すると、そのパソコンは攻撃者からの指示を待つ状態になり、一度攻撃者から指示が送られてくると、指示通りの攻撃（スパムメールの送信など）を行う。

## スパムメール
悪質な詐欺であるスパムメールも多く、規制が進みつつある。
基本的な態度は次の二つ。

### オプトアウト
- 未承諾で広告メールを送って良い。
- 未承諾であることと、解約手順をメール内に明示。

### オプトイン
- 未承諾で広告メールを送ってはならない。

### 対策
- メールサーバの第三者中継は禁止する。
- 送信ドメイン認証（SPF、DomainKeysなど）で、送信者の真正性を確認する。